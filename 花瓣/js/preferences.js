"use strict";function i18nReplace(b,a){return document.querySelector(b).innerText=chrome.i18n.getMessage(a)}function initI18n(){i18nReplace("head > title","extName");i18nReplace("#main .box h2","preferences");i18nReplace("#main label[for=pinSetting]","toggleBtnText");i18nReplace("#main label[for=minWidth]","minImageSide");i18nReplace("#main label[for=shortcutSetting]","shortcutSetting");i18nReplace("#area_capture_text","captureArea");i18nReplace("#viewport_capture_text","captureViewport");i18nReplace("#fullpage_capture_text","captureFullpage");i18nReplace("#feedback","feedback");i18nReplace("#feedback_text","feedbackText");document.querySelector("#huaban_logo").title=chrome.i18n.getMessage("about")}function initShowPin(){var a=document.querySelector("#togglePinButton");var b=document.querySelector("#togglePinButton ~ label");a.checked=!(localStorage.toggle=="off");b.innerHTML=localStorage.toggle=="off"?chrome.i18n.getMessage("hidePinButton"):chrome.i18n.getMessage("showPinButton");a.addEventListener("click",function(){chrome.runtime.sendMessage({msg:"toggle",toggle:this.checked},function(c){b.innerHTML=c.isToggleOn?chrome.i18n.getMessage("showPinButton"):chrome.i18n.getMessage("hidePinButton")})});setInterval(function(){a.checked=!(localStorage.toggle=="off");b.innerHTML=localStorage.toggle=="off"?chrome.i18n.getMessage("hidePinButton"):chrome.i18n.getMessage("showPinButton")},500)}function initMinWidth(){var b=document.querySelector("#minWidth");var a=document.querySelector("#minWidth ~ label");b.value=a.innerHTML=localStorage.minWidth||200;b.addEventListener("change",function(){a.innerHTML=localStorage.minWidth=this.value})}function initUser(){var b=Huaban.getUser();if(b){var e=document.getElementById("authorization");var g=e.getElementsByClassName("line")[0];var c=document.createElement("a");c.href=Utils.getUserUrl(b);c.target="_blank";c.classList.add("icon");var a=new Image();if(b.avatar){a.src=Utils.getImgUrl(b.avatar,"sq75")}else{a.src="/images/default_buddy_icon.jpg"}var f=document.createTextNode(b.name);var d=document.createElement("span");d.classList.add("removeAuth");d.title=d.innerHTML=chrome.i18n.getMessage("remove_auth");d.addEventListener("click",function(){e.innerHTML="";e.style.display="none";Huaban.removeUser(b.id);return false});c.appendChild(a);c.appendChild(f);g.appendChild(c);g.appendChild(d);e.style.display="block"}}function initHotkeys(){var a=document.querySelector("#toggleShortcut");var c=document.querySelector("#toggleShortcut ~ label");var e=document.querySelector("#shortcut_prompt");var d=function(f){a.checked=f;if(f){HotKey.enable()}else{HotKey.disable()}};var b=a.checked=HotKey.isEnabled();c.innerHTML=b?chrome.i18n.getMessage("hideShortcut"):chrome.i18n.getMessage("showShortcut");e.style.display=b?"block":"none";a.addEventListener("click",function(){d(this.checked);c.innerHTML=HotKey.isEnabled()?chrome.i18n.getMessage("hideShortcut"):chrome.i18n.getMessage("showShortcut");e.style.display=HotKey.isEnabled()?"block":"none"})}window.addEventListener("load",function(){initI18n();initShowPin();initMinWidth();initUser();initHotkeys()});